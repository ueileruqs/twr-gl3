

<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Enviar Dados para Google Sheets</title>
  <script>
    async function enviarDadosParaSheets(dados) {
      const url = "https://script.google.com/macros/s/AKfycbz2dZdmfqddwzRxmVZNMI0qfmTKBJ54iemfoKrYxoQ/dev"; // substitua pela URL do seu Web App

      try {
        const resposta = await fetch(url, {
          method: "POST",
          body: JSON.stringify(dados),
          headers: { "Content-Type": "application/json" }
        });

        const json = await resposta.json();
        if (json.status === "ok") {
          alert("Dados enviados com sucesso!");
          document.getElementById('formDados').reset();
        } else {
          alert("Erro ao enviar dados: " + json.message);
        }
      } catch (err) {
        alert("Erro na requisição: " + err.message);
      }
    }

    function handleSubmit(event) {
      event.preventDefault();

      const dados = {
        indicativo: document.getElementById("indicativo").value.trim(),
        tipoAeronave: document.getElementById("tipoAeronave").value.trim(),
        rwy: document.getElementById("rwy").value.trim(),
        origemDestino: document.getElementById("origemDestino").value.trim(),
        obs: document.getElementById("obs").value.trim()
      };

      enviarDadosParaSheets(dados);
    }
  </script>
</head>
<body class="p-6">
  <h1>Enviar Dados para Google Sheets</h1>

  <form id="formDados" onsubmit="handleSubmit(event)" style="max-width: 400px;">
    <div>
      <label for="indicativo">INDICATIVO:</label><br />
      <input type="text" id="indicativo" name="indicativo" required />
    </div>
    <div>
      <label for="tipoAeronave">TIPO AERONAVE (ICAO):</label><br />
      <input type="text" id="tipoAeronave" name="tipoAeronave" required />
    </div>
    <div>
      <label for="rwy">RWY:</label><br />
      <input type="text" id="rwy" name="rwy" required />
    </div>
    <div>
      <label for="origemDestino">ORIGEM / DESTINO:</label><br />
      <input type="text" id="origemDestino" name="origemDestino" required />
    </div>
    <div>
      <label for="obs">OBSERVAÇÕES:</label><br />
      <textarea id="obs" name="obs" rows="3"></textarea>
    </div>
    <div style="margin-top: 12px;">
      <button type="submit" style="padding: 8px 20px;">Enviar</button>
    </div>
  </form>
</body>
</html>

